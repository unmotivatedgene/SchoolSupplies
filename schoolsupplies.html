<!DOCTYPE html>
<html lang="en">

<head>
    <script>
        // Example JSON data
        const data = {
            "Items": {
                "Scissors": {
                    "Name": "5-inch pointed scissors",
                    "Unit": [],
                    "Count": 1
                },
                "Crayons_24": {
                    "Name": "24-Pack Crayola Crayons",
                    "Unit": ["Pack", "Packs"],
                    "Count": 24
                },
                "Plastic_Folders": {
                    "Name": "Plastic Folders",
                    "Unit": ["", ""],
                    "Count": 1
                },
                "Wide_Ruled_Notebook_Paper": {
                    "Name": "Wide Ruled Notebook Paper",
                    "Unit": ["Pack", "Packs"],
                    "Count": 70
                },
                "Pink_Baloons": {
                    "Name": "Pink Baloons",
                    "Unit": ["Box", "Boxes"],
                    "Count": 6,
                    "Sex": "Girls"
                },
                "Glue_Sticks": {
                    "Name": "Glue Sticks",
                    "Unit": ["", ""],
                    "Count": 1
                },
                "Markers": {
                    "Name": "Markers",
                    "Unit": ["Pack", "Packs"],
                    "Count": 10
                },
                "Erasers": {
                    "Name": "Erasers",
                    "Unit": ["", ""],
                    "Count": 1
                }
            },
            "SchoolSupplies": {
                "TEST ISD Elementary": {
                    "4th Grade Supply List 2024-2025": {
                        "Wide_Ruled_Notebook_Paper": {
                            "Total": 1,
                            "Sex": "Boys"
                        },
                        "Plastic_Folders": {
                            "Total": 3,
                            "Note": "1 red, 1 blue, 1 yellow"
                        },
                        "Scissors_Boys": {
                            "Item": "Scissors",
                            "Total": 1,
                            "Note": "(Hiskar Brand)",
                            "Sex": "Boys"
                        },
                        "Scissors_Girls": {
                            "Item": "Scissors",
                            "Total": 1,
                            "Note": "(Misskar Brand)",
                            "Sex": "Girls"
                        },
                        "Crayons_24": {
                            "Total": 2
                        },
                        "Glue_Sticks": {
                            "Total": 5
                        },
                        "Markers": {
                            "Total": 2
                        }
                    },
                    "2nd Grade Supply List 2024-2025": {
                        "Wide_Ruled_Notebook_Paper": {
                            "Total": 1
                        },
                        "Plastic_Folders": {
                            "Total": 2,
                            "Note": "1 green, 1 purple"
                        },
                        "Scissors": {
                            "Total": 1
                        },
                        "Crayons_24": {
                            "Total": 1
                        },
                        "Glue_Sticks": {
                            "Total": 3
                        },
                        "Erasers": {
                            "Total": 2
                        }
                    }
                }
            }
        };

        const schoolSupplies = data.SchoolSupplies;

        function populateSchools() {
            const schoolDropdown = document.querySelector(".schoolDropdown");

            for (let school in schoolSupplies) {
                const option = document.createElement("option");
                option.value = school;
                option.textContent = school;
                schoolDropdown.appendChild(option);
            }
        }

        function populateGrades(schoolDropdown) {
            const selectedSchool = schoolDropdown.value;
            const gradeDropdown = schoolDropdown.closest('.gradeSet').querySelector('.gradeDropdown');
            gradeDropdown.innerHTML = '';

            if (selectedSchool) {
                for (let grade in schoolSupplies[selectedSchool]) {
                    const option = document.createElement("option");
                    option.value = grade;
                    option.textContent = grade;
                    gradeDropdown.appendChild(option);
                }
            }
        }

        function generateList() {
            const gradeSets = document.querySelectorAll(".gradeSet");
            const combinedList = document.getElementById("combinedList");
            const separateLists = document.getElementById("separateLists");

            combinedList.innerHTML = '';
            separateLists.innerHTML = '';

            let combinedItems = {};
            let separateItems = {};

            gradeSets.forEach((gradeSet) => {
                const schoolDropdown = gradeSet.querySelector(".schoolDropdown");
                const gradeDropdown = gradeSet.querySelector(".gradeDropdown");
                const boysInput = gradeSet.querySelector(".boysInput");
                const girlsInput = gradeSet.querySelector(".girlsInput");
                const anyInput = gradeSet.querySelector(".anyInput");

                const school = schoolDropdown.value;
                const grade = gradeDropdown.value;
                const boysCount = parseInt(boysInput.value, 10) || 0;
                const girlsCount = parseInt(girlsInput.value, 10) || 0;
                const anyCount = parseInt(anyInput.value, 10) || 0;

                if (!separateItems[school]) {
                    separateItems[school] = {};
                }

                ['Boys', 'Girls', 'Any'].forEach(gender => {
                    const genderCount = gender === 'Boys' ? boysCount : gender === 'Girls' ? girlsCount : anyCount;

                    if (genderCount !== 0) {
                        if (!separateItems[school][grade]) {
                            separateItems[school][grade] = {};
                        }
                        if (!separateItems[school][grade][gender]) {
                            separateItems[school][grade][gender] = [];
                        }

                        const supplyList = schoolSupplies[school][grade];
                        for (let itemKey in supplyList) {
                            const supplyItem = supplyList[itemKey];
                            const item = data.Items[supplyItem.Item || itemKey];

                            if (!supplyItem.Sex || supplyItem.Sex === gender || gender === 'Any') {
                                const separateItem = {
                                    text: item.Name,
                                    unit: item.Unit,
                                    quantity: supplyItem.Total * genderCount,
                                    countPerUnit: item.Count,
                                    note: supplyItem.Note || ""
                                };

                                separateItems[school][grade][gender].push(separateItem);

                                if (combinedItems[itemKey]) {
                                    combinedItems[itemKey].quantity += supplyItem.Total * genderCount;
                                    if (combinedItems[itemKey].note && supplyItem.Note) {
                                        combinedItems[itemKey].note += `, ${supplyItem.Note}`;
                                    } else if (supplyItem.Note) {
                                        combinedItems[itemKey].note = supplyItem.Note;
                                    }
                                } else {
                                    combinedItems[itemKey] = {
                                        text: item.Name,
                                        unit: item.Unit,
                                        quantity: supplyItem.Total * genderCount,
                                        countPerUnit: item.Count,
                                        note: supplyItem.Note || ""
                                    };
                                }
                            }
                        }
                    }
                });
            });

            for (let key in combinedItems) {
                const listItem = document.createElement("li");
                const unit = combinedItems[key].unit.length > 0 && combinedItems[key].unit[0] ? (combinedItems[key].quantity > 1 ? combinedItems[key].unit[1] : combinedItems[key].unit[0]) : "";
                const note = combinedItems[key].note ? ` - ${combinedItems[key].note}` : "";
                const perUnit = combinedItems[key].countPerUnit > 1 && unit ? `(${combinedItems[key].countPerUnit} per ${combinedItems[key].unit[0]})` : "";
                listItem.innerHTML = `<input type="checkbox"> ${combinedItems[key].quantity} ${unit ? unit + " of" : ""} ${combinedItems[key].text} ${perUnit}${note}`;
                combinedList.appendChild(listItem);
            }

            for (let school in separateItems) {
                const schoolHeading = document.createElement("h3");
                schoolHeading.innerText = school;
                separateLists.appendChild(schoolHeading);

                for (let grade in separateItems[school]) {
                    for (let gender in separateItems[school][grade]) {
                        const genderHeading = document.createElement("h4");
                        genderHeading.innerText = `${grade} ${gender}`;
                        separateLists.appendChild(genderHeading);

                        const separateList = document.createElement("ul");

                        separateItems[school][grade][gender].forEach(item => {
                            const unit = item.unit.length > 0 && item.unit[0] ? (item.quantity > 1 ? item.unit[1] : item.unit[0]) : "";
                            const note = item.note ? ` - ${item.note}` : "";
                            const perUnit = item.countPerUnit > 1 && unit ? `(${item.countPerUnit} per ${item.unit[0]})` : "";
                            const listItem = document.createElement("li");
                            listItem.innerHTML = `<input type="checkbox"> ${item.quantity} ${unit ? unit + " of" : ""} ${item.text} ${perUnit}${note}`;
                            separateList.appendChild(listItem);
                        });

                        separateLists.appendChild(separateList);
                    }
                }
            }
        }

        function addGradeSet() {
            const gradeSet = document.querySelector('.gradeSet').cloneNode(true);
            gradeSet.querySelector('.schoolDropdown').value = '';
            gradeSet.querySelector('.gradeDropdown').innerHTML = '';
            gradeSet.querySelector('.boysInput').value = '';
            gradeSet.querySelector('.girlsInput').value = '';
            gradeSet.querySelector('.anyInput').value = '';
            document.getElementById('gradesContainer').appendChild(gradeSet);
        }

        document.addEventListener('DOMContentLoaded', () => {
            populateSchools();
        });
    </script>
    <style>
        /* General styling */
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            margin: 0;
            padding: 0 10px;
            color: #333;
        }

        h2, h3, h4 {
            background-color: #2C3E50;
            color: #ECF0F1;
            padding: 10px;
            border-radius: 5px;
            margin-top: 20px;
        }

        button {
            padding: 10px 20px;
            margin: 10px 5px;
            border: none;
            border-radius: 5px;
            background-color: #2980B9;
            color: white;
            cursor: pointer;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: #3498DB;
        }

        /* Grades container styling */
        #gradesContainer {
            background-color: #ECF0F1;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .gradeSet {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            justify-content: center;
            gap: 15px;
            width: 100%;
            max-width: 800px;
        }

        .schoolDropdown, .gradeDropdown, .boysInput, .girlsInput, .anyInput {
            padding: 10px;
            border: 1px solid #BDC3C7;
            border-radius: 5px;
            background-color: #fff;
        }

        .gradeDropdown {
            margin-left: 0;
        }

        /* List styling */
        #separateLists, #combinedList {
            background-color: #ECF0F1;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-top: 10px;
        }

        #combinedList {
            list-style-type: none;
            padding-left: 0;
        }

        #combinedList li {
            padding: 8px 10px;
            border-bottom: 1px solid #BDC3C7;
        }

        #combinedList li:last-child {
            border-bottom: none;
        }

        .buttonContainer {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
        }

        @media (max-width: 600px) {
            .gradeSet {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>School Supplies List</title>
</head>

<body>

    <h2>Enter Details</h2>
    <div id="gradesContainer">
        <div class="gradeSet">
            <select class="schoolDropdown" onchange="populateGrades(this)">
                <option value="">Select School</option>
                <!-- Schools will be populated dynamically -->
            </select>
            <select class="gradeDropdown">
                <option value="">Select Grade</option>
                <!-- Grades will be populated dynamically -->
            </select>
            Boys:
            <input type="number" class="boysInput" min="0" value="0">
            Girls:
            <input type="number" class="girlsInput" min="0" value="0">
            Any:
            <input type="number" class="anyInput" min="0" value="0">
        </div>
    </div>
    <div class="buttonContainer">
        <button onclick="addGradeSet()">+ Add Another Grade</button>
        <button onclick="generateList()">Submit</button>
    </div>
    <h2>Combined Shopping List</h2>
    <ul id="combinedList"></ul>

    <h2>Individual List</h2>
    <div id="separateLists"></div>

</body>

</html>
